package pdf_test

import (
	"bytes"
	"io/ioutil"
	"testing"

	"github.com/stretchr/testify/assert"
	"github.com/stretchr/testify/require"

	"github.com/toaster/pdf"
)

func TestPdf_ExtractText(t *testing.T) {
	tests := map[string]struct {
		src       string
		wantPages int
		want      []string
	}{
		"multiple content streams per page": {
			src:       "testdata/multi_stream_content.pdf",
			wantPages: 6,
			want: []string{
				"Are You Asking Your CMSVendor the Right Questions?scrivito.com",
				"scrivito.com2How does the CMS help me to improve website projects?How does the CMS support team collaboration in the project and later?How does the CMS a\x1fect my business case?Is the UI easy to understand and use without training?How does the CMS deal with customer experience?Where is the limit in visitors/users/transactions per month for the CMS?Is the CMS limiting my ideas for the web project?What does the CMS do to support SEO?What does the CMS o\x1fer to ensure fast page loading times?   Is there a need to involve the IT administration?   1.2.3.4.5.6.7.8.9.10.Choosing the right Content Management System (CMS) for your web project at first could appear to bea momentous task. However, if you ask the right questions before you get too deep, your whole project will come together more easily than you can imagine and you\u0092ll be well on your way to a successful launch.Here are ten things you can ask of the CMS vendor to help you choose the right modern Web CMS.",
				"3How does the CMShelp me to improve website projects?When it comes to selecting a CMS in today's modern environment, you really have three main choices to pickbetween. First, you can choose to go with a basic but functional CMS like WordPress. Secondly, you can chooseto utilize a more advanced CMS framework on the other end of the complexity spectrum, with Joomla being justone of many examples. Finally, you may choose to implement the needed CMS functionality on your own accord.In order to be sure that you're making the right decision, you need to look out for a few key characteristics.The CMS you choose needs to yield instant results through the entirety of the project lifecycle, from the first pitchto its eventual launch. Any high quality CMS deployment should also have on-demand availability. You shouldn'tneed to install any so\x1fware, manage any upgrades on your own, look for available plug-ins and more.You certainly shouldn't need to purchase any additional hardware for your business to get the CMS o\x1e the ground.You should be able to load up your browser, sign in and start working.The CMS vendor that you choose should also be able to display the flexibility that you will need moving forward.It should be easy to integrate and even easier to extend this functionality on an as-needed basis. Your CMS shouldalso have a high degree of useful, prefabricated templates and widgets and support the integration of popularweb frameworks like Bootstrap, for example.Finally, your CMS solution should be able to grow and evolve as your business does the same. If you needto be able to reuse certain components from other projects, be they third party elements or your own, your CMSshould allow you to do that. Most importantly, your CMS should require minimal operating e\x1eort through allstages of the project to truly allow you to create the high quality content that you're a\x1fer.scrivito.comHow does the CMS support teamcollaboration in the project and later?Nowadays, you rarely can limit access to a system to a fixed set of physical locations. You need to be browser-based,permitting access from anywhere. How does the CMS support this while supporting the division of work betweenan arbitrary number of editors, designers, and programmers? Is there a concept of an editorial team where youhave workspaces and previews before being released to the masses? Does the CMS detect conflicts deriving fromconcurrent editing and how does the CMS support the resolution of such conflicts? 1.2.",
				"4How does the CMSa\x1fect my business case?When choosing a CMS, you typically want something with a low cost to get started. You may want to create a proofof concept project to help get buy-in from the company, but you want a low cost and minimal investment for thisearly stage project. Is the system pay-as-you-go or does it require dedicated hardware and server so\x1fware?Can you get started without having to add new IT sta\x1e or fixed data center fees? The higher the up front cost,the higher the risk in choosing a CMS. Everything might look great on paper, but if you can\u0092t kick the tires a little,you\u0092ll never know for sure if the choice is right, if the startup costs are exorbitant, and you need upper managementapproval to take the costly risk.scrivito.comIs the UI easy to understandand use without training?Some personnel balk at the concept of adding a CMS to their everyday project workflow. If they have to take aweek of training before they get started, not only are users behind a week but they quickly learn why they neededthat week of training. The system may just be too complicated and requires a long ramp up time. A Drag and DropWYSIWYG system will get a team up and running much more quickly.How does the CMS deal withcustomer experience?A website run by a CMS requires some extra work to ensure users can find and use the content, but potentiallymore importantly, the search engines can find and read the content. Is there internationalization, localization,and personalization support available? What about SEO support? How much of the meta tags can be configuredand how much of the support files can be automated? This also deals with responsive design if your users cancome through from multiple platforms and devices. You don\u0092t want to lock out mobile users and deal with themin version two of the system.3.4.5.",
				"5Where is the limit in visitors/users/transactionsper month for the CMS?Is the CMS size constrained? If your project takes o\x1f in popularity, do you have to change CMSs because you\u0092veoutgrown infrastructure limitations? Are there upper limits for tra\x1fic? Obviously, something like Twitter andPinterest require some level of customization given their current sizes. But, in their early days, were they flexibleenough to handle their instant growth patterns? Is scalability an option? As rich content assets like videos orhigh-res images become more and more popular, is the CMS limited in the number of content objects or in thesize of these objects?scrivito.comIs the CMS limiting my ideasfor the web project?Does the CMS restrict you from doing what you want with the web site or are you constrained to do everythingwithin the CMS? Is the CMS an open framework, o\x1fering the building blocks for a successful system or a closedenvironment? You don\u0092t want the CMS to get in your way as you expand beyond your initial needs.What does the CMS doto support SEO?Being found by search engines is important for most websites. A CMS might have a feature checkbox for SEOsupport, but what exactly does that SEO support involve? Does it have support for a full set of features for on-pageoptimizations? Is the URL structure SEO friendly? Is there XML sitemap creation support? Does it avoid Flash?Are there tools for editors? The more help you can get from the CMS, the better optimized a site could be.You don\u0092t need to use all the features immediately, but you want them there.6.7.8.",
				"6What does the CMS o\x1ferto ensure fast page loading times?Loading times are incredibly important in today's modern environment. Studies have shown that users willtypically only spend three seconds or less waiting for a page to load, at which point they will almost certainly gosomewhere else to find the information that they're looking for. As a result, load times should always be one ofyour primary concerns and the CMS that you choose needs to reflect that idea.When searching for a CMS, you should be looking for one that not only o\x1fers automatic load balancing, cachingand fast loading times via a CDN, but other advanced features at well. Instead of shunning multimedia elementslike rich media or video in fear of what they might do to your load times, you should be instead searching fora CMS deployment that will allow you to incorporate these elements and still have the lightning fast page thatyou can depend on.Your CMS should also include support for an elastic infrastructure, meaning that it should be able to scale content,users and workspaces as the needs of your site continue to change. Instead of planning for the infrastructurethat you think you're going to have tomorrow, elastic infrastructure and CMS in general can help you accountfor the specifically needed demand of the present. This will ultimately create a much more functional,higher quality site as a result.Is there a need to involvethe IT administration?Lastly, how much need is there to involve the IT administration? Beyond just hiring sta\x1f who understands theintricacies of the CMS, you may need to have to add more security and backup requirements. With a so\x1eware asa service (SaaS) approach, there are no so\x1eware packages that need to be installed and maintained, and noadditional IT infrastructure is needed. The number of questions you should ask before choosing a modernWeb CMS is endless. These ten should provide a good basis for you making the right decision for your company.9.10.Sign up for a free trial for Scrivito at https://scrivito.com Scrivito is proudly made by Infopark in Berlin, Germanyscrivito.com",
			},
		},
		"unclear bug in PDFv1.6 document": {
			src:       "testdata/buggy-pdf-v1.6.pdf",
			wantPages: 12,
			want: []string{
				"Statistischer BerichtE II 1/ E III 1 - m 08/21Baugewerbein BerlinAugust 2021Ergebnisse des Bauhaupt- undAusbaugewerbes statistik  Berlin Brandenburg",
				"ImpressumStatistischer BerichtE II 1 / E III 1 - m 08/21Erscheinungsfolge: monatlichErschienen im Oktober 2021HerausgeberZeichenerklärungAmt für Statistik Berlin-Brandenburg0weniger als die Hälfte von 1 Steinstraße 104 - 106in der letzten besetzten Stelle,14480 Potsdamjedoch mehr als nichtsinfo@statistik-bbb.de–nichts vorhandenwww.statistik-berlin-brandenburg.de…Angabe fällt später an( )Aussagewert ist eingeschränktTel. 0331 8173 \u2009- 1777/Zahlenwert nicht sicher genugFax 030 9028\u2009 - \u20094091•Zahlenwert unbekannt odergeheim zu halten xTabellenfach gesperrt pvorläufige Zahlrberichtigte Zahlsgeschätzte ZahlAmt für Statistik Berlin-Brandenburg, Potsdam, 2021http://creativecommons.org/licenses/by/3.0/de/ Dieses Werk ist unter einer Creative Commons Lizenz vom Typ Namensnennung 3.0 Deutschland zugänglich. Um eine Kopie dieser Lizenz einzusehen, konsultieren Sie",
				"SeiteSeiteMetadaten zum Monatsbericht Bauhauptgewerbe (externer Link)Metadaten zum Auftragsbestand (externer Link)Metadaten zur vj. Erhebung Ausbaugewerbe (externer Link)TabellenBauhauptgewerbe Ausbaugewerbe / Bauträger1Betriebe, tätige Personen und Entgelte7Betriebe, tätige Personen, Arbeitsstunden in Berlin seit Januar 2020und Entgelte(Monatsberichtskreis)............................................4sowie Umsätze in Berlinseit dem 1. Vierteljahr 2020...................................102Geleistete Arbeitsstunden in Berlin seit Januar 20208Betriebe, tätige Personen, Arbeitsstunden(Monatsberichtskreis)............................................5und Entgelte sowie Umsätze in Berlin 3Umsatzim 2. Vierteljahr 2021 nach Wirtschaftszweigen....11in Berlin seit Januar 2020(Monatsberichtskreis)............................................64Auftragseingangin Berlin seit Januar 2020(Monatsberichtskreis)............................................75Auftragsbestand in Berlin seit dem 1. Vierteljahr 2020(Monatsberichtskreis)............................................86Ausgewählte Kennziffern in Berlinim August 2021 nach Wirtschaftszweigen(Monatsberichtskreis)............................................9 statistik  Berlin BrandenburgInhaltsverzeichnisStatistischer Bericht E II 1 / E III 1 –  m 08/21 ",
				"– 4 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  1 000 EUR2020  Januar  261 15 075 46 690  Februar  261 15 085 47 225  März  260 15 183 47 159  April  260 14 811 49 773  Mai  258 14 873 47 602  Juni  258 15 025 50 207  Juli  258 15 072 53 530  August  258 15 107 49 416  September  259 15 269 52 432  Oktober  260 15 255 50 787  November  260 15 203 58 113  Dezember260 15 012 51 5822020¹  259 15 081 604 5162021  Januar284 15 866 48 975  Februar  283 15 805 46 486  März  283 15 931 51 995  April  283 16 013 56 180  Mai  283 15 971 54 063  Juni  283 15 958 57 305  Juli  283 15 921 56 703  August  280 15 966 55 261  September... ... ...   Oktober... ... ...   November... ... ...   Dezember... ... ... 2021... ... ... Veränderung in %  zum   Vormonat– 1,10,3– 2,5  Vorjahresmonat8,55,711,8  Vorjahreszeitraum9,16,09,0_____1 Betriebe und tätige Personen im Jahresdurchschnitt1  Betriebe, tätige Personen und Entgelte       im Bauhauptgewerbe in Berlin seit Januar 2020    (Monatsberichtskreis)JahrMonatEntgelteBetriebeAnzahlTätige Personen im Bauhauptgewerbe",
				"– 5 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  Woh-nungs-baugewerbl.undindustr.Hochbauöffentl. Hochbaugewerbl.undindustr.TiefbauStraßen-bausonst.Tief-bauAnzahl2020  Januar22 1 392  796  573  143  81  596  326  166  104  Februar20 1 445  818  581  156  81  627  328  192  106  März22 1 617  877  643  153  81  740  414  212  114  April20 1 54581356715393731399211121  Mai18 1 46379656814782666342200124  Juni21 1 61786962915881747388229130  Juli23 1 62588365014191742400229112  August21 1 54083361513582707356216135  September22 1 66788262815599785408236140  Oktober22 1 628852602157  93776407230  140  November21 1 668869599175  96799465195  138  Dezember22 1 276  721  505  132  84  555  293  167  952020254 18 483 10 009 7 160 1 805 1 044 8 471 4 526 2 483 1 4592021  Januar20 1 283  742  508  155  80  541  325  113  102  Februar20 1 312  771  551  139  82  541  309  125  106  März22 1 746  935  677  157  101  811  447  221  143  April20 1 668  866  618  158  90  803  442  219  142  Mai19 1 581  869  645  141  82  712  391  191  130  Juni22 1 739  916  654  170  92  823  443  239  142  Juli22 1 633  867  634  152  81  766  409  221  136  August22 1 620  836  601  153  81  785  441  221  123  September22... ... ... ... ... ... ... ... ...   Oktober21... ... ... ... ... ... ... ... ...   November22... ... ... ... ... ... ... ... ...   Dezember23... ... ... ... ... ... ... ... ... 2021255... ... ... ... ... ... ... ... ... Veränderung¹ in %  zum   Vormonatx– 0,8– 3,6– 5,20,70,02,57,80,0– 9,6  Vorjahresmonatx0,4– 4,2– 6,78,2– 5,76,018,2– 2,3– 13,0  Vorjahreszeitraumx2,41,51,22,82,23,58,2– 7,17,5_____1 Veränderung je Arbeitstag gerechnetIns-gesamt1 000 Stunden2   Geleistete Arbeitsstunden      im Bauhauptgewerbe in Berlin seit Januar 2020     (Monatsberichtskreis)JahrMonatArbeits-tageDavon imHoch-bauTiefbauDavon im",
				"– 6 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  Woh-      nungsbaugewerbl. und industr. Hochbauöffentl. Hochbaugewerbl. und industr. TiefbauStraßen- bausonst. Tiefbau2020  Januar 220  779 220  640 149  652 107  355 28  812 13  485 70  988 41  975 18  526 10  487  Februar 249  049 248  923 167  169 117  120 32  978 17  071 81  754 55  200 19  984 6  569  März 301  875 301  526 198  991 141  685 39  669 17  637 102  535 66  107 26  972 9  455  April 289  122 288  907 188  535 129  682 42  973 15  880 100  372 64  702 25  497 10  174  Mai 314  125 313  817 192  349 126  766 46  593 18  989 121  468 76  921 29  045 15  502  Juni 312  769 312  354 205  099 137  179 51  532 16  388 107  256 65  657 27  154 14  445  Juli 315  226 314  975 206  638 144  832 36  574 25  233 108  337 66  857 29  495 11  984  August 308  298 308  143 200  659 140  708 40  113 19  838 107  484 58  658 31  310 17  516  September 313  871 313  717 209  359 137  952 38  432 32  974 104  358 59  399 29  806 15  153  Oktober 327  954 327  706 205  643 143  543 38  789 23  311 122  063 69  505 32  118 20  440  November 323  875 323  605 195  103 128  563 41  262 25  277 128  502 75  342 27  658 25  501  Dezember 376  109 374  763 243  637 165  353 55  571 22  713 131  126 82  861 27  462 20  80220203 653 0523 649 0762 362 8341 620 738 493 298 248 7961 286 243 783 184 325 027 178 0282021  Januar 204  155 204  016 140  896 84  905 33  269 22  722 63  119 39  217 13  346 10  557  Februar 219  303 219  024 145  137 95  777 33  891 15  470 73  886 49  140 13  992 10  755  März 279  543 279  132 185  388 124  724 40  284 20  380 93  744 55  645 19  673 18  426  April 272  934 272  500 169  975 114  667 36  689 18  620 102  526 58  960 27  947 15  619  Mai 284  184 284  061 190  181 126  482 41  015 22  648 93  880 55  949 21  502 16  429  Juni 315  239 314  862 210  050 144  822 44  617 20  612 104  812 63  784 25  094 15  934  Juli 292  258 292  055 190  300 126  878 35  522 27  900 101  755 58  537 26  587 16  630  August 290  434 290  162 182  089 125  428 38  237 18  424 108  073 59  607 32  787 15  680  September... ... ... ... ... ... ... ... ... ...   Oktober... ... ... ... ... ... ... ... ... ...   November... ... ... ... ... ... ... ... ... ...   Dezember... ... ... ... ... ... ... ... ... ... 2021... ... ... ... ... ... ... ... ... ... Veränderung in %  zum  Vormonat– 0,6– 0,6– 4,3– 1,17,6– 34,06,21,823,3– 5,7  Vorjahresmonat– 5,8– 5,8– 9,3– 10,9– 4,7– 7,10,51,64,7– 10,5  Vorjahreszeitraum– 6,6– 6,6– 6,3– 9,7– 4,915,4– 7,3– 11,1– 13,024,93  Umsatz      im Bauhauptgewerbe in Berlin seit Januar 2020    (Monatsberichtskreis)JahrMonat1 000 EURDarunter baugewerblicher Umsatzins-                                                                                                                                                                                                                                                                                           gesamtGesamt-umsatzHochbauTiefbaudavon im davon im ",
				"– 7 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  Woh-nungs-baugewerbl. und industr. Hochbauöffentl. Hochbaugewerbl. und industr. TiefbauStraßen-bausonst. Tiefbau2020  Januar 278  808 193  486 133  853 29  204 30  428 85  322 57  195 16  754 11  372  Februar 247  135 144  139 80  526 29  666 33  948 102  995 71  623 22  316 9  057  März 271  909 195  935 100  581 84  642 10  712 75  974 34  245 30  488 11  241  April 175  558 78  413 61  170 11  314 5  928 97  145 54  122 25  813 17  210  Mai 181  790 103  173 74  564 22  837 5  771 78  617 40  087 29  123 9  408  Juni 171  030 101  238 61  485 28  033 11  719 69  792 40  647 14  997 14  149  Juli 178  703 92  226 62  257 17  111 12  857 86  478 47  313 28  468 10  697  August 187  145 123  773 87  445 26  318 10  010 63  372 37  740 19  409 6  224  September 246  663 154  724 122  218 26  427 6  079 91  938 45  996 35  420 10  522  Oktober 319  239 235  992 183  939 45  956 6  097 83  247 56  802 15  985 10  461  November 257  282 193  200 154  541 30  052 8  607 64  082 38  200 11  457 14  425  Dezember 286  486 204  904 179  233 18  838 6  832 81  582 53  803 21  331 6  44820202 801 7481 821 2031 301 812 370 398 148 988 980 544 577 773 271 561 131 2142021  Januar 220  443 146  587 112  216 20  467 13  904 73  856 47  789 15  428 10  640  Februar 261  050 176  786 135  248 24  289 17  249 84  264 34  238 40  331 9  695  März 206  964 120  690 80  793 27  211 12  687 86  274 53  972 21  537 10  766  April 268  231 148  939 102  788 25  129 21  021 119  292 63  575 29  471 26  247  Mai 277  930 139  096 68  265 57  195 13  636 138  833 90  802 28  720 19  312  Juni 319  670 223  555 127  294 84  995 11  266 96  115 54  033 34  600 7  482  Juli 297  983 218  589 183  584 16  426 18  580 79  394 41  015 26  403 11  976  August 280  847 202  370 164  068 29  438 8  865 78  477 49  526 22  359 6  592  September... ... ... ... ... ... ... ... ...   Oktober... ... ... ... ... ... ... ... ...   November... ... ... ... ... ... ... ... ...   Dezember... ... ... ... ... ... ... ... ... 2021... ... ... ... ... ... ... ... ... Veränderung in %  zum   Vormonat– 5,8– 7,4– 10,679,2– 52,3– 1,220,8– 15,3– 45,0  Vorjahresmonat50,163,587,611,9– 11,423,831,215,25,9  Vorjahreszeitraum26,133,347,214,5– 3,414,713,616,814,9Jahr                                                                                                                                                                                                                                                                                                                                                                                                                               Monat1 000 EUR4  Auftragseingang     im Bauhauptgewerbe in Berlin seit Januar 2020    (Monatsberichtskreis)Ins-   gesamtHochbauTiefbauDavon im Davon im ",
				"– 8 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  Wohnungs- baugewerbl. und industr. Hochbauöffentl. Hochbaugewerbl. und industr. TiefbauStraßen- bausonst. Tiefbau2020  1. Vj.1 953 1131 333 063 603 004 561 082 168 978 620 050 314 089 221 943 84 018  2. Vj.1 806 6301 169 550 548 573 468 902 152 075 637 081 318 754 218 407 99 920  3. Vj.1 716 0461 106 379 535 319 442 433 128 627 609 667 289 729 224 921 95 018  4. Vj.1 695 2601 159 868 620 450 435 374 104 044 535 392 286 202 197 630 51 5612021  1. Vj.1 888 5631 290 899 766 088 391 796 133 016 597 664 309 661 216 963 71 041  2. Vj.2 039 9901 347 050 743 428 472 540 131 083 692 940 363 403 237 293 92 244  3. Vj.... ... ... ... ... ... ... ... ...   4. Vj.... ... ... ... ... ... ... ... ... Veränderung in %  zum  Vorquartal8,04,3– 3,020,6– 1,515,917,49,429,8  Vorjahresquartal12,915,235,50,8– 13,88,814,08,6– 7,75  Auftragsbestand     im Bauhauptgewerbe in Berlin seit Januar 2020    (Monatsberichtskreis)ZeitraumIns-gesamt1 000 EURHochbauTiefbauDavon im Davon im ",
				"– 9 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  1 00041.2/4243.1/43.9Bauhauptgewerbe insgesamt28015 9661 62055 261290 434290 16241.2Bau von Gebäuden 865 355 52019 244136 113135 94341.20.1Bau von Gebäuden (ohne Fertigteilbau)85•••••���������������������������������������•••••����������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������•••••������������������������������•••••���������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������•••••��������������������������������•••••����������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������������•••••�������������������������������������������������������•••••��������������������������������������������������������������6  Ausgewählte Kennziffern im Bauhauptgewerbe     in Berlin im August 2021 nach Wirtschaftszweigen     (Monatsberichtskreis)WirtschaftszweigGeleistete Arbeits-stundenWZ2008BetriebeTätige Personenim Bau-haupt-gewerbeAnzahlGesamt-umsatzDarunter                                                                                                                                                                                                                                                        bau-                                                                                                                                                                                            gewerblich1 000 EUR",
				"– 10 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  1 0002020  1. Vj.  331 17 509 5 957 143 541 482 559 477 557  2. Vj.   327 17 483 5 812 149 172 511 553 505 049  3. Vj.   325 17 761 5 998 151 529 577 470 571 365  4. Vj.   324 17 730 6 011 158 194 736 039 727 6612020  327 17 621 23 778 602 4362 307 6212 281 6322021²  1. Vj.405 19 826 6 501 165 495 513 201 507 324  2. Vj.  404 19 692 6 434 172 565 601 580 594 921  3. Vj.... ... ... ... ... ...   4. Vj.... ... ... ... ... ... 2021... ... ... ... ... ... Veränderung in %  zum  Vorquartal– 0,2– 0,7– 1,04,317,217,3  Vorjahresquartal23,512,610,715,717,617,8  Vorjahreszeitraum22,912,99,915,512,112,2_____1 Betriebe und tätige Personen am Ende des Berichtsvierteljahres,  2020 im Jahresdurchschnitt 2 Eingeschränkte Vergleichbarkeit aufgrund der Absenkung der Berichtskreisuntergrenze    von 23 auf 20 und mehr tätige Personen ab 2021Darunter bau-gewerblich7  Betriebe, tätige Personen, Arbeitsstunden und Entgelte sowie Umsätze     im Ausbaugewerbe in Berlin seit dem 1. Vierteljahr 2020Geleistete Arbeits-               stundenEntgelteZeitraumBetriebe¹ Tätige Personen¹  im Ausbaugew.Gesamt-umsatz1 000 EURAnzahl",
				"– 11 – Amt für Statistik Berlin-Brandenburg — SB E II 1/ E III 1 - m 08/21 –  Berlin  1 00043.2Bauinstallation 27214 8974 907136 110461 706455 34343.21Elektroinstallation 894 0641 42836 625117 223111 75543.22Gas-, Wasser-, Heizungs-, Lüftungs-u. Klimainstallation 1246 6772 05861 427203 360202 54943.29.1Dämmung gegen Kälte, Wärme,Schall und Erschütterung 282 129 76312 58148 45448 45443.29.9Sonstige Bauinstallation a.n.g. 312 027 65925 47892 66992 58543.3 1324 7951 52736 455139 874139 57843.31Anbringen von Stuckaturen, Gipserei und Verputzerei 381 355 3889 71640 11140 00443.32Bautischlerei und -schlosserei 20 586 1974 69018 21718 18843.33Fußboden-, Fliesen-, Plattenlegerei, Tapeziererei 24 722 2234 85924 16024 10843.34.1Maler- und Lackierergewerbe 461 870 63914 43541 35541 29543.34.2Glasergewerbe 2•••••43.39Sonstiger Ausbau a.n.g. 2•••••43.2/43.3 40419 6926 434172 565601 580594 92141.1 4 116x1 62625 948x_____1 Betriebe und tätige Personen im Ausbaugewerbe am Ende des Berichtsvierteljahres; bei Bauträgern Gesamtzahl tätige PersonenDarunter bau-gewerblich1 000 EUR8  Betriebe, tätige Personen, Arbeitsstunden und Entgelte sowie Umsätze im Ausbau-    gewerbe und bei Bauträgern in Berlin im 2. Vierteljahr 2021 nach WirtschaftszweigenWZ 2008Betriebe¹Geleistete Arbeits-stundenWirtschaftszweigEntgelteGesamt-umsatzTätige Personen¹ im Ausbaugew.AnzahlErschließung von Grundstücken; BauträgerSonstiger AusbauAusbaugewerbe insgesamtAusbaugewerbeBauträger",
				"Das Amt für Statistik  Berlin-Brandenburg   Das Amt für Statistik Berlin-Brandenburg  ist für beide Länder die zentrale Dienst-leistungseinrichtung auf dem Gebiet der amtlichen Statistik. Das Amt erbringt Ser-viceleistungen im Bereich Information und Analyse für die breite Öffentlichkeit, für al-le gesellschaftlichen Gruppen sowie für Kunden aus Verwaltung und Politik, Wirt-schaft und Wissenschaft. Kerngeschäft des Amtes ist die Durchführung der ge-setzlich angeordneten amtlichen Statisti-ken für Berlin und Brandenburg. Das Amt erhebt die Daten, bereitet sie auf, interpre-tiert und analysiert sie und veröffentlicht die Ergebnisse. Die Grundversorgung al-ler Nutzer mit statistischen Informationen erfolgt unentgeltlich, im Wesentlichen über das Internet und den Informations-service. Daneben werden nachfrage- und zielgruppenorientierte Standardauswer-tungen zu Festpreisen angeboten. Kun-denspezifische Aufbereitung / Beratung zu kostendeckenden Preisen ergänzt das Spektrum der Informationsbereitstellung.   Amtliche Statistik im Verbund Die Statistiken werden bundesweit nach einheitlichen Konzepten, Methoden und Verfahren arbeitsteilig erstellt. Die statisti-schen Ämter der Länder sind dabei grundsätzlich für die Durchführung der Erhebungen, für die Aufbereitung und Veröffentlichung der Länderergebnisse zuständig. Durch diese Kooperation in ei-nem „Statistikverbund“ entstehen für alle Länder vergleichbare und zu einem Bun-desergebnis zusammenführbare Erhe-bungsresultate.  Produkte  und Dienstleistungen   Informationsservice info@statistik-bbb.de  mit statistischen Informationen für  jedermann und Beratung sowie maßge- schneiderte Aufbereitungen von Daten  über Berlin und Brandenburg. Auskunft, Beratung, Pressedienst sowie Fachbibliothek.  Standort Potsdam Steinstraße 104 - 106, 14480 Potsdam Tel. 0331 8173 - 1777 Fax 030 9028 - 4091 Mo – Do 9 – 15 Uhr, Fr 9 – 14 Uhr   Standort Berlin Alt-Friedrichsfelde 60, 10315 Berlin  Bibliothek  Tel. 030 9021 - 3540 Mo – Do 9 – 15 Uhr, Fr 9 – 14 Uhr  Internet-Angebot www.statistik-berlin-brandenburg.de  mit aktuellen Daten, Pressemitteilungen,  Statistischen Berichten zum kostenlosen  Herunterladen, regionalstatistischen Informa-tionen, Wahlstatistiken und -analysen sowie  einem Überblick über das gesamte Leis-tungsspektrum des Amtes.  Statistische Jahrbücher mit einer Vielzahl von Tabellen aus nahezu allen Arbeitsgebieten der amtlichen Statistik.  Statistische Berichte mit Ergebnissen der einzelnen Statistiken in Tabellen in tiefer sachlicher Gliederung und Grafiken zur Veranschaulichung von Entwick-lungen und Strukturen.   Datenangebot  aus dem Sachgebiet   Informationen zu dieser Veröffentlichung Referat 32 Tel. 030 9021 - 3593 / 3831 / 3350 Fax 030 9028 - 4014 bau@statistik-bbb.de  Weitere Veröffentlichungen zum Thema Statistische Berichte: • Baugewerbe in Land Brandenburg Ergebnisse der Ergänzungserhebung im Bauhauptgewerbe, der jährlichen Erhe-bung im Ausbaugewerbe und der Investi-tionserhebungen E II 2 / E III 2 -jährlich  Ergebnisse dieser Statistik für das Bundes- gebiet sind den Veröffentlichungen des Sta- tistischen Bundesamtes „Ausgewählte Zah-   len für die Bauwirtschaft“ (monatlich) sowie  der Fachserie 4, Reihe 5.1, „Beschäftigung und Umsatz der Betriebe im Baugewerbe“ (jährlich)  zu entnehmen.     ",
			},
		},
	}
	for name, tt := range tests {
		t.Run(name, func(t *testing.T) {
			data, err := ioutil.ReadFile(tt.src)
			require.NoError(t, err)
			bufReader := bytes.NewReader(data)
			pdfReader, err := pdf.NewReader(bufReader, bufReader.Size())
			if assert.NoError(t, err) {
				totalPage, err := pdfReader.NumPage()
				if assert.NoError(t, err) {
					assert.Equal(t, tt.wantPages, totalPage)
					var texts []string
					for pageIndex := 1; pageIndex <= totalPage; pageIndex++ {
						page, err := pdfReader.Page(pageIndex)
						if assert.NoError(t, err) {
							assert.NotNil(t, page.V)
							content, err := page.Content()
							if assert.NoError(t, err) {
								var text string
								for _, t := range content.Text {
									text += t.S
								}
								texts = append(texts, text)
							}
						}
					}
					assert.Equal(t, tt.want, texts)
				}
			}
		})
	}
}
